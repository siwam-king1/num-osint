<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Phone OSINT Terminal — SIWAM KING</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<style>
  :root{--green:#00ff66;--bg:#000}
  html,body{height:100%;margin:0;background:var(--bg);color:var(--green);font-family:monospace}
  header{padding:1rem;text-align:center;border-bottom:1px solid var(--green);font-size:clamp(1rem,4vw,1.4rem)}
  .container{max-width:1100px;margin:12px auto;padding:12px}
  .input-row{display:flex;gap:10px;flex-wrap:wrap}
  input[type="text"]{flex:1;min-width:220px;padding:.6rem;border:1px solid var(--green);background:#000;color:var(--green)}
  button{padding:.6rem 1rem;background:var(--green);border:1px solid var(--green);color:#000;font-weight:700;cursor:pointer}
  .controls{display:flex;gap:10px;margin-top:10px;flex-wrap:wrap}
  #map{height:420px;border:1px solid var(--green);position:relative;overflow:hidden;margin-top:12px}
  .results{border:1px solid var(--green);padding:12px;margin-top:12px;min-height:140px;max-height:220px;overflow:auto}
  .line{margin:.3rem 0;white-space:pre-wrap;border-right:.12em solid var(--green);animation:typing 1.2s steps(40,end),blink .9s infinite}
  @keyframes typing{from{width:0}to{width:100%}} @keyframes blink{from,to{border-color:transparent}50%{border-color:var(--green)}}
  footer{border-top:1px solid var(--green);text-align:center;padding:8px;margin-top:12px;font-size:.85rem}
  .howto{margin-top:12px;border:1px dashed var(--green);padding:8px;cursor:pointer}
  .howto-content{display:none;margin-top:6px;font-size:.95rem}

  /* Radar overlay styles */
  .radar-overlay{
    position:absolute;pointer-events:none;left:0;top:0;width:100%;height:100%;z-index:450;
    display:flex;align-items:center;justify-content:center;transition:transform 1s ease, width 1s ease, height 1s ease;
  }

  /* rotating beam (conic-gradient) */
  .radar-beam{
    width:80vmin;height:80vmin;border-radius:50%;opacity:.18;
    background: conic-gradient(from 0deg, rgba(0,255,102,0.28) 0deg 10deg, rgba(0,255,102,0.06) 10deg 40deg, transparent 40deg 360deg);
    mix-blend-mode:screen; animation:spin 2s linear infinite; transform-origin:center center;
    box-shadow:0 0 50px rgba(0,255,102,0.06) inset;
  }
  @keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}

  /* small ping that will be placed at marker */
  .ping-dot{ width:160px;height:160px;border-radius:50%;border:2px solid rgba(0,255,102,0.9);pointer-events:none;
    animation:pingAnim 1.8s infinite; box-shadow:0 0 30px rgba(0,255,102,0.12) }
  @keyframes pingAnim{0%{transform:scale(.3);opacity:1}80%{transform:scale(1);opacity:0}100%{opacity:0}}

  /* responsive tweaks */
  @media(max-width:700px){
    #map{height:300px}
    .radar-beam{width:120vmin;height:120vmin}
  }
</style>
</head>
<body>
<header>PHONE OSINT TERMINAL — SIWAM KING  </header>
<div class="container">
  <div class="input-row">
    <input type="text" id="phoneInput" placeholder="Enter phone number (international format preferred e.g. +919876543210 or 9198... )" />
    <button id="scanBtn">SCAN</button>
    <button id="downloadBtn">DOWNLOAD</button>
  </div>

  <div id="map">
 
    <div id="radarOverlay" class="radar-overlay" style="display:none">
      <div id="radarBeam" class="radar-beam"></div>
    </div>
  </div>

  <div class="results" id="results">Awaiting target input...</div>

  <div class="controls">
    <div class="howto" id="howtoToggle">[+] How to Use</div>
    <div class="howto-content" id="howto">1. Enter phone number and click SCAN. 2. Full-map radar sweeps first. 3. When country found, radar flies to country center. 4. When state/city found, radar locks on and marker pings. 5. Download log with DOWNLOAD button.</div>
  </div>
</div>

<footer>© 2025 OSINT Terminal By SIWAMKING — For research/educational use only.</footer>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
/* -------------------------
   Configuration / helpers
   ------------------------- */
const APILAYER_KEY = "7654af068a4129146951e75c6e8c19a3"; // your provided key
const APILAYER_URL = "http://apilayer.net/api/validate"; // note: may be http; use a proxy for production
const NOMINATIM_URL = "https://nominatim.openstreetmap.org/search?format=json&q=";

const resultsEl = document.getElementById('results');
const radarOverlay = document.getElementById('radarOverlay');
const radarBeam = document.getElementById('radarBeam');

function logLine(text, delay = 0){
  return new Promise(res=>{
    setTimeout(()=>{
      const d = document.createElement('div'); d.className='line'; d.textContent = text;
      resultsEl.appendChild(d); resultsEl.scrollTop = resultsEl.scrollHeight;
      res();
    }, delay);
  });
}

function clearLog(){ resultsEl.innerHTML = ""; }

/* -------------------------
   Leaflet map init
   ------------------------- */
const map = L.map('map', { zoomControl: false }).setView([20, 0], 2);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 18, attribution:'' }).addTo(map);
let currentMarker = null;
let currentPingMarker = null;


function latLngToOverlayPos(latlng){
  const containerPoint = map.latLngToContainerPoint(latlng);
  return { x: containerPoint.x, y: containerPoint.y };
}

/* Center radar overlay at pixel x,y and resize */
function moveRadarToPixel(x, y, sizePx){
  radarOverlay.style.display = "flex";
  const mapRect = document.getElementById('map').getBoundingClientRect();

  const centerX = x - mapRect.width/2;
  const centerY = y - mapRect.height/2;
  radarOverlay.style.transform = `translate(${centerX}px, ${centerY}px)`;
  radarBeam.style.width = radarBeam.style.height = (sizePx) + 'px';
}

/* Show full-map sweep */
function startFullSweep(){
  radarOverlay.style.display = "flex";
  radarOverlay.style.transform = `translate(0px, 0px)`;

  const mapRect = document.getElementById('map').getBoundingClientRect();
  const maxDim = Math.max(mapRect.width, mapRect.height) * 2; 
  radarBeam.style.width = radarBeam.style.height = maxDim + 'px';
  radarBeam.style.opacity = 0.5;
}


function hideRadar(){ radarOverlay.style.display = 'none'; }


function placeMarkerWithPing(lat, lon){

  if(currentMarker) { map.removeLayer(currentMarker); currentMarker=null; }
  if(currentPingMarker) { map.removeLayer(currentPingMarker); currentPingMarker=null; }

  currentMarker = L.marker([lat, lon]).addTo(map);


  const pingDiv = document.createElement('div');
  pingDiv.className = 'ping-dot';

  const icon = L.divIcon({
    html: pingDiv,
    className: '',
    iconSize: [160,160],
    iconAnchor: [80,80]
  });
  currentPingMarker = L.marker([lat, lon], {icon: icon, interactive:false}).addTo(map);
}

/* Download results */
function downloadLog(){
  const text = resultsEl.innerText;
  const blob = new Blob([text], {type:'text/plain'});
  const a = document.createElement('a'); a.href = URL.createObjectURL(blob);
  a.download = 'phone_osint_log.txt'; a.click();
}


async function geocode(query){
  try{
    const r = await fetch(NOMINATIM_URL + encodeURIComponent(query), {headers: {'Accept':'application/json'}});
    if(!r.ok) return [];
    const j = await r.json();
    return j; 
  }catch(e){
    console.error('Geocode error', e);
    return [];
  }
}

/* Country fallback centers (if geocode fails) */
const countryFallbacks = {
  "India":[20.5937,78.9629],
  "United States":[37.0902,-95.7129],
  "United Kingdom":[55.3781,-3.4360],
  
};

/* -------------------------
   Scan logic (main)
   ------------------------- */
const scanBtn = document.getElementById('scanBtn');
const toggleBtn = document.getElementById('toggleBtn');
const downloadBtn = document.getElementById('downloadBtn');
const howtoToggle = document.getElementById('howtoToggle');
const howtoContent = document.getElementById('howto');

toggleBtn.addEventListener('click', ()=> {
  resultsEl.style.display = resultsEl.style.display === 'none' ? 'block' : 'none';
});
downloadBtn.addEventListener('click', downloadLog);
howtoToggle.addEventListener('click', ()=> {
  howtoContent.style.display = howtoContent.style.display === 'block' ? 'none' : 'block';
});

scanBtn.addEventListener('click', startScan);

async function startScan(){
  const phone = document.getElementById('phoneInput').value.trim();
  if(!phone){ alert('Enter phone number'); return; }

  clearLog();
 
  startFullSweep();
  await logLine(`[*] Initiating scan on target: ${phone}`, 150);


  const apiPromise = fetch(`${APILAYER_URL}?access_key=${APILAYER_KEY}&number=${encodeURIComponent(phone)}&format=1`)
    .then(r=>r.json())
    .catch(e=>({error:e}));

  await logLine(`[*] Connecting to telecom databases...`, 600);

  const apidata = await apiPromise;
  console.log('apidata', apidata);

  if(apidata.error){
    await logLine(`[ERROR] API request failed: ${apidata.error}`, 400);
    hideRadar();
    return;
  }

  if(!apidata.valid){
    await logLine(`[ERROR] Invalid phone number or no data found.`, 400);
    hideRadar();
    return;
  }

 
  const rawCountry = apidata.country_name || '';
  const countryClean = rawCountry.replace(/\(.*?\)/g,'').trim();
  if(apidata.carrier) await logLine(`[OK] Carrier: ${apidata.carrier}`, 300);
  if(rawCountry) await logLine(`[OK] Country: ${rawCountry} (${apidata.country_code||''})`, 300);
  if(apidata.location) await logLine(`[OK] Location: ${apidata.location}`, 300);
  if(apidata.line_type) await logLine(`[OK] Line Type: ${apidata.line_type}`, 300);


  if(countryClean){
    await logLine(`[*] Locating country center for "${countryClean}"...`, 200);


    const countryGeo = await geocode(countryClean);
    let countryLat=null, countryLon=null;
    if(countryGeo && countryGeo.length>0){
      countryLat = parseFloat(countryGeo[0].lat);
      countryLon = parseFloat(countryGeo[0].lon);
    } else if(countryFallbacks[countryClean]){
      [countryLat, countryLon] = countryFallbacks[countryClean];
    }

    if(countryLat && countryLon){
  
      const p = latLngToOverlayPos([countryLat, countryLon]);
 
      const latlng = L.latLng(countryLat, countryLon);
      const pt = map.latLngToContainerPoint(latlng);
      moveRadarToPixel(pt.x, pt.y, Math.max(200, Math.max(map.getSize().x, map.getSize().y) * 0.8));
  
      map.flyTo([countryLat, countryLon], 4, {duration:1.2});
      await logLine(`[*] Country acquired — moving radar to ${countryClean}`, 800);
    } else {
      await logLine(`[!] Country geocode failed — keeping full-map sweep`, 400);
    }
  }


  let finalLat=null, finalLon=null;
  let searchQuery = "";
  if(apidata.location && countryClean) searchQuery = `${apidata.location}, ${countryClean}`;
  else if(countryClean) searchQuery = countryClean;

  if(searchQuery){
    await logLine(`[*] Resolving location: "${searchQuery}"...`, 350);
    const geoRes = await geocode(searchQuery);
    if(geoRes && geoRes.length>0){
      finalLat = parseFloat(geoRes[0].lat);
      finalLon = parseFloat(geoRes[0].lon);

      const pt = map.latLngToContainerPoint([finalLat, finalLon]);
      moveRadarToPixel(pt.x, pt.y, 220); 
      map.flyTo([finalLat, finalLon], apidata.location ? 10 : 5, {duration:1.0});
      await logLine(`[*] Location resolved — locking on ${apidata.location || countryClean}`, 700);

      
      placeMarkerWithPing(finalLat, finalLon);
      await logLine(`[*] Scan complete.`, 350);
    } else {
     
      if(typeof countryLat !== 'undefined' && countryLat !== null){
        finalLat = countryLat; finalLon = countryLon;
        const pt = map.latLngToContainerPoint([finalLat, finalLon]);
        moveRadarToPixel(pt.x, pt.y, 280);
        map.flyTo([finalLat, finalLon], 4, {duration:1.0});
        placeMarkerWithPing(finalLat, finalLon);
        await logLine(`[*] Location not specific — marked country center. Scan complete.`, 350);
      } else {
        await logLine(`[!] Could not resolve any coordinates. Scan stopped.`, 200);
      }
    }
  } else {
    await logLine(`[!] No searchable location string available.`, 200);
  }

  
  radarBeam.style.opacity = 0; 
  setTimeout(()=>{ radarOverlay.style.display='none'; radarBeam.style.opacity=0.18; }, 900);
}

/* -------------------------
   Helper UI functions
   ------------------------- */
function moveRadarToPixel(x,y,sizePx){
  
  const mapEl = document.getElementById('map');
  const mw = mapEl.clientWidth, mh = mapEl.clientHeight;
 
  const centerX = x - mw/2;
  const centerY = y - mh/2;
  radarOverlay.style.display = 'flex';
  radarOverlay.style.transform = `translate(${centerX}px, ${centerY}px)`;
  radarBeam.style.width = radarBeam.style.height = sizePx + 'px';
}


async function logLineSync(text, delay=0){ await logLine(text, delay); }

/* -------------------------
   Attach initial handlers
   ------------------------- */

radarOverlay.style.display = 'none';

document.getElementById('downloadBtn').addEventListener('click', downloadLog);


</script>
</body>
</html>
